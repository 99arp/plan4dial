{
    "name": "order-pizza",
    "context-variables": {
        "order": {
            "type": "enum",
            "config": [
                "cheese",
                "pepperoni",
                "mushroom",
                "gluten free",
                "hawaiian"
            ]
        },
        "order_available": {
            "type": "flag",
            "config": false
        },
        "location": {
            "type": "json",
            "config": {
                "extraction": "spacy",
                "method": "gpe"
            }
        },
        "start_location": {
            "type": "json",
            "config": {
                "extraction": "spacy",
                "method": "gpe"
            }
        },
        "end_location": {
            "type": "json",
            "config": {
                "extraction": "spacy",
                "method": "gpe"
            }
        },
        "payment_method": {
            "type": "enum",
            "config": [
                "credit",
                "debit",
                "cash"
            ]
        },
        "card_number": {
            "type": "json",
            "config": {
                "extraction": "regex",
                "pattern": "\\d{16}"
            }
        },
        "goal": {
            "type": "flag",
            "config": false
        }
    },
    "intents": {
        "greet": {
            "variables": [],
            "utterances": [
                "Hey",
                "Hi",
                "hey there"
            ]
        },
        "leave": {
            "variables": [],
            "utterances": [
                "Goodbye",
                "Bye",
                "That's all",
                "i'm done"
            ]
        },
        "confirm": {
            "variables": [],
            "utterances": [
                "yes",
                "yeah",
                "that's it",
                "Y",
                "mhm",
                "confirm",
                "yes please"
            ]
        },
        "deny": {
            "variables": [],
            "utterances": [
                "no",
                "not at all",
                "that's not what i meant",
                "absolutely not",
                "i don't want that",
                "nah",
                "no thanks",
                "no thank you"
            ]
        },
        "share_order": {
            "variables": [
                "$order"
            ],
            "utterances": [
                "I want a $order pizza",
                "$order pizza please!",
                "Do you have $order pizza?"
            ]
        },
        "share_location": {
            "variables": [
                "$location"
            ],
            "utterances": [
                "I live in $location.",
                "Do you deliver to $location?",
                "I want my pizza to be delivered to $location."
            ]
        },
        "share_two_locations": {
            "variables": [
                "$start_location",
                "$end_location"
            ],
            "utterances": [
                "Can you deliver from $start_location to $end_location?",
                "I want my pizza to be delivered from $start_location to $end_location.",
                "Do you travel from $start_location to $end_location?"
            ]
        },
        "set_payment_method": {
            "variables": [
                "$payment_method"
            ],
            "utterances": [
                "I want to pay by $payment_method.",
                "Can I pay with $payment_method?",
                "I will pay in $payment_method"
            ]
        },
        "pay": {
            "variables": [
                "$card_number"
            ],
            "utterances": [
                "My credit card number is $card_number.",
                "This is my account number $card_number",
                "Ok, the number on my card is $card_number."
            ]
        },
        "location-unclear": {
            "variables": [],
            "utterances": []
        },
        "order-unclear": {
            "variables": [],
            "utterances": []
        },
        "payment_method-unclear": {
            "variables": [],
            "utterances": []
        },
        "card_number-unclear": {
            "variables": [],
            "utterances": []
        }
    },
    "actions": {
        "ask-location": {
            "name": "ask-location",
            "type": "dialogue",
            "subtype": "dialogue disambiguation",
            "message_variants": [
                "Where are you located?",
                "Where do you live?",
                "Where would you like to deliver?"
            ],
            "condition": [
                [
                    "location",
                    "Unknown"
                ]
            ],
            "effect": {
                "global-outcome-name": "validate-response",
                "type": "oneof",
                "outcomes": [
                    {
                        "name": "ask-location_DETDUP_validate-response-EQ-valid",
                        "updates": {
                            "location": {
                                "variable": "location",
                                "value": "$location",
                                "certainty": "Known",
                                "interpretation": "spel"
                            }
                        },
                        "assignments": {
                            "$location": "found"
                        },
                        "intent": "share_location"
                    },
                    {
                        "name": "ask-location_DETDUP_validate-response-EQ-unclear",
                        "updates": {
                            "location": {
                                "variable": "location",
                                "value": "$location",
                                "certainty": "Uncertain",
                                "interpretation": "spel"
                            }
                        },
                        "assignments": {
                            "$location": "maybe-found"
                        },
                        "intent": "location-unclear",
                        "follow_up": {
                            "clarify": "clarify__ask-location"
                        }
                    }
                ]
            },
            "intents": {
                "share_location": {
                    "variables": [
                        "location"
                    ],
                    "utterances": [
                        "I live in $location.",
                        "Do you deliver to $location?",
                        "I want my pizza to be delivered to $location."
                    ]
                },
                "location-unclear": {
                    "variables": [],
                    "utterances": []
                }
            }
        },
        "ask-order": {
            "name": "ask-order",
            "type": "dialogue",
            "subtype": "dialogue disambiguation",
            "message_variants": [
                "What would you like to order?",
                "What type of pizza would you like?"
            ],
            "condition": [
                [
                    "order",
                    "Unknown"
                ]
            ],
            "effect": {
                "global-outcome-name": "validate-response",
                "type": "oneof",
                "outcomes": [
                    {
                        "name": "ask-order_DETDUP_validate-response-EQ-valid",
                        "updates": {
                            "order": {
                                "variable": "order",
                                "value": "$order",
                                "certainty": "Known",
                                "interpretation": "spel"
                            }
                        },
                        "assignments": {
                            "$order": "found"
                        },
                        "intent": "share_order",
                        "follow_up": "check-order-availability"
                    },
                    {
                        "name": "ask-order_DETDUP_validate-response-EQ-unclear",
                        "updates": {
                            "order": {
                                "variable": "order",
                                "value": "$order",
                                "certainty": "Uncertain",
                                "interpretation": "spel"
                            }
                        },
                        "assignments": {
                            "$order": "maybe-found"
                        },
                        "intent": "order-unclear",
                        "follow_up": {
                            "clarify": "clarify__ask-order"
                        }
                    }
                ]
            },
            "intents": {
                "share_order": {
                    "variables": [
                        "order"
                    ],
                    "utterances": [
                        "I want a $order pizza",
                        "$order pizza please!",
                        "Do you have $order pizza?"
                    ]
                },
                "order-unclear": {
                    "variables": [],
                    "utterances": []
                }
            }
        },
        "ask-payment": {
            "name": "ask-payment",
            "type": "dialogue",
            "subtype": "dialogue disambiguation",
            "message_variants": [
                "How would you like to pay?"
            ],
            "condition": [
                [
                    "order",
                    "Known"
                ],
                [
                    "location",
                    "Known"
                ],
                [
                    "payment_method",
                    "Unknown"
                ]
            ],
            "effect": {
                "global-outcome-name": "validate-response",
                "type": "oneof",
                "outcomes": [
                    {
                        "name": "ask-payment_DETDUP_validate-response-EQ-valid",
                        "updates": {
                            "payment_method": {
                                "variable": "payment_method",
                                "value": "$payment_method",
                                "certainty": "Known",
                                "interpretation": "spel"
                            }
                        },
                        "assignments": {
                            "$payment_method": "found"
                        },
                        "intent": "set_payment_method"
                    },
                    {
                        "name": "ask-payment_DETDUP_validate-response-EQ-unclear",
                        "updates": {
                            "payment_method": {
                                "variable": "payment_method",
                                "value": "$payment_method",
                                "certainty": "Uncertain",
                                "interpretation": "spel"
                            }
                        },
                        "assignments": {
                            "$payment_method": "maybe-found"
                        },
                        "intent": "payment_method-unclear",
                        "follow_up": {
                            "clarify": "clarify__ask-payment"
                        }
                    }
                ]
            },
            "intents": {
                "set_payment_method": {
                    "variables": [
                        "payment_method"
                    ],
                    "utterances": [
                        "I want to pay by $payment_method.",
                        "Can I pay with $payment_method?",
                        "I will pay in $payment_method"
                    ]
                },
                "payment_method-unclear": {
                    "variables": [],
                    "utterances": []
                }
            }
        },
        "ask-card-number": {
            "name": "ask-card-number",
            "type": "dialogue",
            "subtype": "dialogue disambiguation",
            "message_variants": [
                "Enter your card number.",
                "Please enter your card details."
            ],
            "condition": [
                [
                    "payment_method",
                    "Known"
                ]
            ],
            "effect": {
                "global-outcome-name": "validate-response",
                "type": "oneof",
                "outcomes": [
                    {
                        "name": "ask-card-number_DETDUP_validate-response-EQ-valid",
                        "updates": {
                            "card_number": {
                                "variable": "card_number",
                                "value": "$card_number",
                                "certainty": "Known",
                                "interpretation": "spel"
                            }
                        },
                        "assignments": {
                            "$card_number": "found"
                        },
                        "intent": "pay"
                    },
                    {
                        "name": "ask-card-number_DETDUP_validate-response-EQ-unclear",
                        "updates": {
                            "card_number": {
                                "variable": "card_number",
                                "value": "$card_number",
                                "certainty": "Uncertain",
                                "interpretation": "spel"
                            }
                        },
                        "assignments": {
                            "$card_number": "maybe-found"
                        },
                        "intent": "card_number-unclear",
                        "follow_up": {
                            "clarify": "clarify__ask-card-number"
                        }
                    }
                ]
            },
            "intents": {
                "pay": {
                    "variables": [
                        "card_number"
                    ],
                    "utterances": [
                        "My credit card number is $card_number.",
                        "This is my account number $card_number",
                        "Ok, the number on my card is $card_number."
                    ]
                },
                "card_number-unclear": {
                    "variables": [],
                    "utterances": []
                }
            }
        },
        "check-order-availability": {
            "name": "check-order-availability",
            "type": "api",
            "condition": [
                [
                    "order",
                    "Known"
                ]
            ],
            "effect": {
                "global-outcome-name": "make-call",
                "type": "oneof",
                "outcomes": [
                    {
                        "name": "check-order-availability_DETDUP_make-call-EQ-in-stock",
                        "updates": {
                            "order_available": {
                                "variable": "order_available",
                                "value": true,
                                "interpretation": "json"
                            }
                        },
                        "assignments": {},
                        "status": "success",
                        "variable_list": []
                    },
                    {
                        "name": "check-order-availability_DETDUP_make-call-EQ-out-of-stock",
                        "updates": {
                            "order": {
                                "variable": "order",
                                "value": null,
                                "certainty": "Unknown",
                                "interpretation": "json"
                            }
                        },
                        "assignments": {
                            "$order": "didnt-find"
                        },
                        "follow_up": "ask-order",
                        "status": "success",
                        "variable_list": []
                    },
                    {
                        "name": "check-order-availability_DETDUP_make-call-EQ-site-down",
                        "assignments": {},
                        "status": 404,
                        "response": "site-down-exit",
                        "variable_list": []
                    }
                ]
            },
            "call": {
                "endpoint": "pizza.actions.check_order_availability",
                "initial_payload": {}
            }
        },
        "place-order": {
            "name": "place-order",
            "type": "api",
            "condition": [
                [
                    "order",
                    "Known"
                ],
                [
                    "card_number",
                    "Known"
                ],
                [
                    "order_available",
                    true
                ]
            ],
            "effect": {
                "global-outcome-name": "make-call",
                "type": "oneof",
                "outcomes": [
                    {
                        "name": "place-order_DETDUP_make-call-EQ-success",
                        "updates": {
                            "goal": {
                                "variable": "goal",
                                "value": true,
                                "interpretation": "json"
                            },
                            "can-do_ask-location": {
                                "variable": "can-do_ask-location",
                                "value": false,
                                "interpretation": "json"
                            },
                            "can-do_ask-order": {
                                "variable": "can-do_ask-order",
                                "value": false,
                                "interpretation": "json"
                            },
                            "can-do_ask-payment": {
                                "variable": "can-do_ask-payment",
                                "value": false,
                                "interpretation": "json"
                            },
                            "can-do_ask-card-number": {
                                "variable": "can-do_ask-card-number",
                                "value": false,
                                "interpretation": "json"
                            },
                            "can-do_check-order-availability": {
                                "variable": "can-do_check-order-availability",
                                "value": false,
                                "interpretation": "json"
                            }
                        },
                        "assignments": {},
                        "status": "success",
                        "response": "Order was successfully placed!",
                        "variable_list": []
                    },
                    {
                        "name": "place-order_DETDUP_make-call-EQ-site-down",
                        "assignments": {},
                        "status": 404,
                        "response": "site-down-exit",
                        "variable_list": []
                    }
                ]
            },
            "call": {
                "endpoint": "pizza.actions.place_order",
                "initial_payload": {}
            }
        },
        "clarify__ask-location": {
            "name": "clarify__ask-location",
            "type": "dialogue",
            "subtype": "dialogue disambiguation",
            "message_variants": [
                "Are you located in $location?",
                "Do you live in $location?"
            ],
            "condition": [
                [
                    "location",
                    "Uncertain"
                ]
            ],
            "effect": {
                "global-outcome-name": "yes-no",
                "type": "oneof",
                "outcomes": [
                    {
                        "name": "clarify__ask-location_DETDUP_yes-no-EQ-confirm",
                        "updates": {
                            "location": {
                                "variable": "location",
                                "value": "$location",
                                "certainty": "Known",
                                "interpretation": "spel"
                            }
                        },
                        "assignments": {
                            "$location": "found"
                        },
                        "intent": "confirm"
                    },
                    {
                        "name": "clarify__ask-location_DETDUP_yes-no-EQ-deny",
                        "updates": {
                            "location": {
                                "variable": "location",
                                "value": null,
                                "certainty": "Unknown",
                                "interpretation": "json"
                            }
                        },
                        "assignments": {
                            "$location": "didnt-find"
                        },
                        "intent": "deny"
                    }
                ]
            },
            "intents": {
                "confirm": {
                    "utterances": [
                        "yes",
                        "yeah",
                        "that's it",
                        "Y",
                        "mhm",
                        "confirm",
                        "yes please"
                    ]
                },
                "deny": {
                    "utterances": [
                        "no",
                        "not at all",
                        "that's not what i meant",
                        "absolutely not",
                        "i don't want that",
                        "nah",
                        "no thanks",
                        "no thank you"
                    ]
                }
            }
        },
        "clarify__ask-order": {
            "name": "clarify__ask-order",
            "type": "dialogue",
            "subtype": "dialogue disambiguation",
            "message_variants": [
                "Would you like to order $order?"
            ],
            "condition": [
                [
                    "order",
                    "Uncertain"
                ]
            ],
            "effect": {
                "global-outcome-name": "yes-no",
                "type": "oneof",
                "outcomes": [
                    {
                        "name": "clarify__ask-order_DETDUP_yes-no-EQ-confirm",
                        "updates": {
                            "order": {
                                "variable": "order",
                                "value": "$order",
                                "certainty": "Known",
                                "interpretation": "spel"
                            }
                        },
                        "assignments": {
                            "$order": "found"
                        },
                        "intent": "confirm"
                    },
                    {
                        "name": "clarify__ask-order_DETDUP_yes-no-EQ-deny",
                        "updates": {
                            "order": {
                                "variable": "order",
                                "value": null,
                                "certainty": "Unknown",
                                "interpretation": "json"
                            }
                        },
                        "assignments": {
                            "$order": "didnt-find"
                        },
                        "intent": "deny"
                    }
                ]
            },
            "intents": {
                "confirm": {
                    "utterances": [
                        "yes",
                        "yeah",
                        "that's it",
                        "Y",
                        "mhm",
                        "confirm",
                        "yes please"
                    ]
                },
                "deny": {
                    "utterances": [
                        "no",
                        "not at all",
                        "that's not what i meant",
                        "absolutely not",
                        "i don't want that",
                        "nah",
                        "no thanks",
                        "no thank you"
                    ]
                }
            }
        },
        "clarify__ask-payment": {
            "name": "clarify__ask-payment",
            "type": "dialogue",
            "subtype": "dialogue disambiguation",
            "message_variants": [
                "Would you like to pay with $payment_method?"
            ],
            "condition": [
                [
                    "payment_method",
                    "Uncertain"
                ]
            ],
            "effect": {
                "global-outcome-name": "yes-no",
                "type": "oneof",
                "outcomes": [
                    {
                        "name": "clarify__ask-payment_DETDUP_yes-no-EQ-confirm",
                        "updates": {
                            "payment_method": {
                                "variable": "payment_method",
                                "value": "$payment_method",
                                "certainty": "Known",
                                "interpretation": "spel"
                            }
                        },
                        "assignments": {
                            "$payment_method": "found"
                        },
                        "intent": "confirm"
                    },
                    {
                        "name": "clarify__ask-payment_DETDUP_yes-no-EQ-deny",
                        "updates": {
                            "payment_method": {
                                "variable": "payment_method",
                                "value": null,
                                "certainty": "Unknown",
                                "interpretation": "json"
                            }
                        },
                        "assignments": {
                            "$payment_method": "didnt-find"
                        },
                        "intent": "deny"
                    }
                ]
            },
            "intents": {
                "confirm": {
                    "utterances": [
                        "yes",
                        "yeah",
                        "that's it",
                        "Y",
                        "mhm",
                        "confirm",
                        "yes please"
                    ]
                },
                "deny": {
                    "utterances": [
                        "no",
                        "not at all",
                        "that's not what i meant",
                        "absolutely not",
                        "i don't want that",
                        "nah",
                        "no thanks",
                        "no thank you"
                    ]
                }
            }
        }
    }
}